import{_ as M,u as E,r as a,w as N,c as m,e as _,d as e,f as y,v as b,t as C,o as f,g as R,h as L,i as S,j}from "./index-CxPmLex7.js";/* empty css             */const B={key:0,class:"modal-backdrop"},I={class:"modal-content"},A={key:0},D=["disabled"],G={key:1},T=["disabled"],q={key:2},z=["readonly"],F=["disabled"],K={key:3},O={style:{color:"#8ab191","font-weight":"bold"}},H={key:4,style:{"margin-top":"12px",color:"#d32f2f"}},J={__name:"PasswordResetModal",props:{show:Boolean},emits:["close"],setup(P, {emit:x}){const V=P,c=E(),s=a("email"),u=a(""),g=a(""),d=a(""),k=a(!1),$=a(!1),p=a(""),h=a(""),t=a(""),n=a(!1);N(()=>V.show, i=>{i||U()});function U(){s.value="email",u.value="",d.value="",k.value=!1,$.value=!1,p.value="",h.value="",t.value="",n.value=!1}async function r(){n.value=!0,t.value="";try{await c.sendEmail(u.value),k.value=!0,s.value="verify",t.value="인증번호가 전송되었습니다."}catch{t.value="이메일 전송에 실패했습니다."}finally{n.value=!1}}async function l(){n.value=!0,t.value="";try{await c.checkEmailCode(u.value,d.value),c.emailVerified?($.value=!0,s.value="reset",t.value="이메일 인증 성공!",g.value=u.value):t.value="인증번호가 올바르지 않습니다."}catch{t.value="인증에 실패했습니다."}finally{n.value=!1}}async function w(){if(console.log("resetPassword 함수 진입"),!p.value||p.value!==h.value){t.value="비밀번호가 일치하지 않습니다.";return}n.value=!0,t.value="";try{console.log("비밀번호 변경 요청:",g.value,p.value);const i=await c.resetPassword({email:g.value,newPassword:p.value});console.log("비밀번호 변경 응답:",i),i.success?(s.value="done",t.value="비밀번호가 성공적으로 변경되었습니다."):t.value=i.message||"비밀번호 변경에 실패했습니다."}catch(i){t.value="비밀번호 변경 요청에 실패했습니다.",console.error(i)}finally{n.value=!1}}return(i, o)=>P.show?(f(),m("div",B,[e("div",I,[e("button",{class:"modal-close",onClick:o[0]||(o[0]= v=>i.$emit("close"))},"×"),o[7]||(o[7]=e("div",{class:"modal-title"},"비밀번호 재설정",-1)),s.value==="email"?(f(),m("div",A,[y(e("input",{"onUpdate:modelValue":o[1]||(o[1]= v=>u.value=v),type:"email",placeholder:"이메일 입력",style:{width:"100%","margin-bottom":"8px"}},null,512),[[b,u.value]]),e("button",{class:"modal-btn",onClick:r,disabled:n.value||!u.value},"이메일 인증 보내기",8,D)])):s.value==="verify"?(f(),m("div",G,[y(e("input",{"onUpdate:modelValue":o[2]||(o[2]= v=>d.value=v),type:"text",placeholder:"인증번호 입력",style:{width:"100%","margin-bottom":"8px"}},null,512),[[b,d.value]]),e("button",{class:"modal-btn",onClick:l,disabled:n.value||!d.value},"인증 확인",8,T)])):s.value==="reset"?(f(),m("div",q,[y(e("input",{"onUpdate:modelValue":o[3]||(o[3]= v=>u.value=v),type:"email",placeholder:"이메일 입력",readonly:$.value,style:{width:"100%","margin-bottom":"8px"}},null,8,z),[[b,u.value]]),y(e("input",{"onUpdate:modelValue":o[4]||(o[4]= v=>p.value=v),type:"password",placeholder:"새 비밀번호 입력",style:{width:"100%","margin-bottom":"8px"}},null,512),[[b,p.value]]),y(e("input",{"onUpdate:modelValue":o[5]||(o[5]= v=>h.value=v),type:"password",placeholder:"비밀번호 확인",style:{width:"100%","margin-bottom":"8px"}},null,512),[[b,h.value]]),e("button",{class:"modal-btn",onClick:w,disabled:n.value||!p.value||!h.value},"비밀번호 변경",8,F)])):s.value==="done"?(f(),m("div",K,[e("div",O,C(t.value),1),e("button",{class:"modal-btn",onClick:o[6]||(o[6]= v=>i.$emit("close"))},"닫기")])):_("",!0),t.value&&s.value!=="done"?(f(),m("div",H,C(t.value),1)):_("",!0)])])):_("",!0)}},Q=M(J,[["__scopeId","data-v-8a91f9ed"]]),W={class:"auth-bg"},X={class:"auth-card"},Y={class:"auth-input-group"},Z={key:0,class:"auth-error"},ee={class:"auth-input-group"},le={key:0,class:"auth-error"},te={class:"auth-forgot"},oe={key:0,class:"auth-error"},ae="http://localhost:5173/auth/loading",se="http://localhost:5173/auth/googleloading",ie={__name:"LoginPage",setup(P){const x=j(),V=E(),c=a(""),s=a(""),u=a(""),g=a(""),d=a(""),k=a(!1),$=async()=>{if(g.value="",d.value="",u.value="",!c.value||c.value.trim()===""){g.value="이메일을 입력해주세요.";return}if(!s.value||s.value.trim()===""){d.value="비밀번호를 입력해주세요.";return}const r=await V.login({email:c.value,password:s.value});r.success?x.push("/"):r.message&&r.message.includes("이메일")?g.value=r.message:r.message&&r.message.includes("비밀번호")?d.value=r.message:u.value=r.message},p=()=>{V.resetAll(),x.push("/join")},h=`https://kauth.kakao.com/oauth/authorize?client_id=88bfa8b4d388fa64195c1c13747bc0ff&redirect_uri=${ae}&response_type=code&prompt=select_account`,t=()=>{window.location.href=h},n=`https://accounts.google.com/o/oauth2/v2/auth?client_id=621454264251-e7vmm3ltoi2p27krvctie68fjtnjhfub.apps.googleusercontent.com&redirect_uri=${se}&response_type=code&scope=email%20profile`,U=()=>{window.location.href=n};return(r, l)=>(f(),m("div",W,[e("div",X,[l[10]||(l[10]=e("div",{class:"auth-card-bar"},null,-1)),l[11]||(l[11]=e("h2",{class:"auth-title"},"LOG IN",-1)),e("form",{onSubmit:L($,["prevent"])},[e("div",Y,[l[4]||(l[4]=e("label",null,"Email",-1)),y(e("input",{type:"email","onUpdate:modelValue":l[0]||(l[0]= w=>c.value=w),required:""},null,512),[[b,c.value]]),g.value?(f(),m("div",Z,C(g.value),1)):_("",!0)]),e("div",ee,[l[5]||(l[5]=e("label",null,"Password",-1)),y(e("input",{type:"password","onUpdate:modelValue":l[1]||(l[1]= w=>s.value=w),required:""},null,512),[[b,s.value]]),d.value?(f(),m("div",le,C(d.value),1)):_("",!0)]),l[8]||(l[8]=e("div",{class:"auth-divider"},[e("span",null,"Social LogIn")],-1)),e("div",{class:"auth-social-row"},[e("button",{type:"button",class:"auth-social-btn",onClick:U},l[6]||(l[6]=[e("span",{class:"icon-google"},null,-1),S(" Google ")])),e("button",{onClick:t,type:"button",class:"auth-social-btn"},l[7]||(l[7]=[e("span",{class:"icon-kakao"},null,-1),S(" Kakao ")]))]),e("div",te,[e("a",{href:"#",onClick:l[2]||(l[2]=L(w=>k.value=!0,["prevent"]))},"Forgot Password")]),l[9]||(l[9]=e("button",{type:"submit",class:"auth-submit"},"Log In",-1)),u.value?(f(),m("div",oe,C(u.value),1)):_("",!0)],32)]),e("div",{class:"auth-side"},[l[12]||(l[12]=e("p",null,"Don't have an account?",-1)),e("button",{class:"auth-side-btn",onClick:p},"Sign Up")]),R(Q,{show:k.value,onClose:l[3]||(l[3]= w=>k.value=!1)},null,8,["show"])]))}};export{ie as default};
